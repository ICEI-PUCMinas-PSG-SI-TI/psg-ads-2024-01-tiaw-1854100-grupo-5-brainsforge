<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>

  <link rel="stylesheet" href="/assets/styles/login.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

</head>

<body>

  <header id="header">

  </header>

  <main>
    <form class="formulario">
      <h3>Iniciar sessão</h3>
      <label id="label_email">E-mail ou nome de usuário</label>
      <input type="email" id="email">
      <label id="label_senha">Senha</label>
      <input type="password" id="senha">
      <h5 id="msg_erro"></h5>
      <button type="button" id="btn_login">Continuar com email</button>
      <h5>Não possui uma conta? <span><a href="#">Cadastre-se</a></span></h5>
    </form>

  </main>

  <footer id="footer">

  </footer>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script src="/assets/scripts/login-admin.js"></script>

  <script>
    function Login() {
      let senha = document.getElementById("senha").value;
      let email_user = document.getElementById("email").value;
      let error = document.getElementById("msg_erro");
      let email_label = document.getElementById("label_email");
      let senha_label = document.getElementById("label_senha");

      let obj_dados = Ler_dados();

      let email_true = obj_dados.users.find(function (elem) { return elem.email == email_user });
      let user_true = obj_dados.users.find(function (elem) { return elem.usuario == email_user })
      let senha_true = obj_dados.users.find(function (elem) { return elem.senha == senha });

      if (senha == "" || email_user == "") {
        email_label.style.color = "rgb(255, 109, 109)";
        senha_label.style.color = "rgb(255, 109, 109)";
        error.innerText = "Preencha todos os campos!";
      }

      else if (user_true == undefined && email_true == undefined) {
        email_label.style.color = "rgb(255, 109, 109)";
        senha_label.style.color = "white";
        error.innerText = "Email ou nome de usuário incorreto!";
      }

      else if (senha_true == undefined) {
        senha_label.style.color = "rgb(255, 109, 109)";
        email_label.style.color = "white";
        error.innerText = "Senha incorreta!";  
      }

      if (senha_true && (email_user == "admin" || email_user == "admin@gmail.com")) {
        email_label.style.color = "white";
        senha_label.style.color = "white";
        error.innerText = "";
        location.href = "admin.html";
      }

      else if ((email_true || user_true) && senha_true) {
        email_label.style.color = "white";
        senha_label.style.color = "white";
        error.innerText = "";
        location.href = "home.html";
      }

    }

    function Salvar_dados(accounts13) {
      localStorage.setItem("accounts13", JSON.stringify(accounts13));
    }

    document.getElementById("btn_login").addEventListener('click', Login);
  </script>

</body>

</html>